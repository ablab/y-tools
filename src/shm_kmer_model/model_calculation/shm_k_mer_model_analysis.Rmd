---
title: "SHM_model_analysis"
author: "Andy"
date: "March 3, 2016"
output: html_document
---


```{r}
setwd('/home/ashlemov/chihua/')
```

```{r}
library(lattice)
```

```{r}
shm.k.mer.model.reader <- function(filepath) {
  model <- read.csv(filepath)
  rownames(model) <- model$X
  model$X <- NULL
  #cbind(model / rowSums(model), N=rowSums(model))
  model
}
```

```{r}
yale.shm <- read.csv('/home/ashlemov/Yandex.Disk/Documents/lab/vers2/src/shm_kmer_model/output/yale_substitution.csv', sep=" ")
rownames(yale.shm) <- yale.shm$Fivemer
yale.shm$Fivemer <- NULL
head(yale.shm)
```

```{r}
syn <- which(yale.shm$Source == "Measured")
```


# Loading datasets
## Loading GMC

```{r}
GMC.1.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/1/shm_model/model_trivial_mm.csv")
GMC.2.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/2/shm_model/model_trivial_mm.csv")
GMC.3.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/3/shm_model/model_trivial_mm.csv")
GMC.4.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/4/shm_model/model_trivial_mm.csv")
GMC.5.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/5/shm_model/model_trivial_mm.csv")
GMC.6.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/6/shm_model/model_trivial_mm.csv")
GMC.7.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/7/shm_model/model_trivial_mm.csv")
GMC.8.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/8/shm_model/model_trivial_mm.csv")
GMC.9.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/9/shm_model/model_trivial_mm.csv")
GMC.10.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/10/shm_model/model_trivial_mm.csv")

GMC.IG.trivial <- list(
  GMC.1.IG.trivial,
  GMC.2.IG.trivial,
  GMC.3.IG.trivial,
  GMC.4.IG.trivial,
  GMC.5.IG.trivial,
  GMC.6.IG.trivial,
  GMC.7.IG.trivial,
  GMC.8.IG.trivial,
  GMC.9.IG.trivial,
  GMC.10.IG.trivial
)
```

```{r}
GMC.1.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/1/shm_model/model_k_neighbour_mm.csv")
GMC.2.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/2/shm_model/model_k_neighbour_mm.csv")
GMC.3.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/3/shm_model/model_k_neighbour_mm.csv")
GMC.4.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/4/shm_model/model_k_neighbour_mm.csv")
GMC.5.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/5/shm_model/model_k_neighbour_mm.csv")
GMC.6.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/6/shm_model/model_k_neighbour_mm.csv")
GMC.7.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/7/shm_model/model_k_neighbour_mm.csv")
GMC.8.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/8/shm_model/model_k_neighbour_mm.csv")
GMC.9.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/9/shm_model/model_k_neighbour_mm.csv")
GMC.10.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IG/10/shm_model/model_k_neighbour_mm.csv")

GMC.IG.k_neighbour <- list(
  GMC.1.IG.k_neighbour,
  GMC.2.IG.k_neighbour,
  GMC.3.IG.k_neighbour,
  GMC.4.IG.k_neighbour,
  GMC.5.IG.k_neighbour,
  GMC.6.IG.k_neighbour,
  GMC.7.IG.k_neighbour,
  GMC.8.IG.k_neighbour,
  GMC.9.IG.k_neighbour,
  GMC.10.IG.k_neighbour
)
```

```{r}
GMC.1.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/1/shm_model/model_trivial_mm.csv")
GMC.2.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/2/shm_model/model_trivial_mm.csv")
GMC.3.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/3/shm_model/model_trivial_mm.csv")
GMC.4.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/4/shm_model/model_trivial_mm.csv")
GMC.5.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/5/shm_model/model_trivial_mm.csv")
GMC.6.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/6/shm_model/model_trivial_mm.csv")
GMC.7.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/7/shm_model/model_trivial_mm.csv")
GMC.8.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/8/shm_model/model_trivial_mm.csv")
GMC.9.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/9/shm_model/model_trivial_mm.csv")
GMC.10.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/10/shm_model/model_trivial_mm.csv")

GMC.IGK.trivial <- list(
  GMC.1.IGK.trivial,
  GMC.2.IGK.trivial,
  GMC.3.IGK.trivial,
  GMC.4.IGK.trivial,
  GMC.5.IGK.trivial,
  GMC.6.IGK.trivial,
  GMC.7.IGK.trivial,
  GMC.8.IGK.trivial,
  GMC.9.IGK.trivial,
  GMC.10.IGK.trivial
)
```

```{r}
GMC.1.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/1/shm_model/model_k_neighbour_mm.csv")
GMC.2.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/2/shm_model/model_k_neighbour_mm.csv")
GMC.3.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/3/shm_model/model_k_neighbour_mm.csv")
GMC.4.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/4/shm_model/model_k_neighbour_mm.csv")
GMC.5.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/5/shm_model/model_k_neighbour_mm.csv")
GMC.6.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/6/shm_model/model_k_neighbour_mm.csv")
GMC.7.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/7/shm_model/model_k_neighbour_mm.csv")
GMC.8.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/8/shm_model/model_k_neighbour_mm.csv")
GMC.9.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/9/shm_model/model_k_neighbour_mm.csv")
GMC.10.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGK/10/shm_model/model_k_neighbour_mm.csv")

GMC.IGK.k_neighbour <- list(
  GMC.1.IGK.k_neighbour,
  GMC.2.IGK.k_neighbour,
  GMC.3.IGK.k_neighbour,
  GMC.4.IGK.k_neighbour,
  GMC.5.IGK.k_neighbour,
  GMC.6.IGK.k_neighbour,
  GMC.7.IGK.k_neighbour,
  GMC.8.IGK.k_neighbour,
  GMC.9.IGK.k_neighbour,
  GMC.10.IGK.k_neighbour
)
```

```{r}
GMC.1.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/1/shm_model/model_trivial_mm.csv")
GMC.2.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/2/shm_model/model_trivial_mm.csv")
GMC.3.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/3/shm_model/model_trivial_mm.csv")
GMC.4.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/4/shm_model/model_trivial_mm.csv")
GMC.5.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/5/shm_model/model_trivial_mm.csv")
GMC.6.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/6/shm_model/model_trivial_mm.csv")
GMC.7.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/7/shm_model/model_trivial_mm.csv")
GMC.8.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/8/shm_model/model_trivial_mm.csv")
GMC.9.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/9/shm_model/model_trivial_mm.csv")
GMC.10.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/10/shm_model/model_trivial_mm.csv")

GMC.IGL.trivial <- list(
  GMC.1.IGL.trivial,
  GMC.2.IGL.trivial,
  GMC.3.IGL.trivial,
  GMC.4.IGL.trivial,
  GMC.5.IGL.trivial,
  GMC.6.IGL.trivial,
  GMC.7.IGL.trivial,
  GMC.8.IGL.trivial,
  GMC.9.IGL.trivial,
  GMC.10.IGL.trivial
)
```

```{r}
GMC.1.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/1/shm_model/model_k_neighbour_mm.csv")
GMC.2.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/2/shm_model/model_k_neighbour_mm.csv")
GMC.3.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/3/shm_model/model_k_neighbour_mm.csv")
GMC.4.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/4/shm_model/model_k_neighbour_mm.csv")
GMC.5.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/5/shm_model/model_k_neighbour_mm.csv")
GMC.6.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/6/shm_model/model_k_neighbour_mm.csv")
GMC.7.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/7/shm_model/model_k_neighbour_mm.csv")
GMC.8.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/8/shm_model/model_k_neighbour_mm.csv")
GMC.9.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/9/shm_model/model_k_neighbour_mm.csv")
GMC.10.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGL/10/shm_model/model_k_neighbour_mm.csv")

GMC.IGL.k_neighbour <- list(
  GMC.1.IGL.k_neighbour,
  GMC.2.IGL.k_neighbour,
  GMC.3.IGL.k_neighbour,
  GMC.4.IGL.k_neighbour,
  GMC.5.IGL.k_neighbour,
  GMC.6.IGL.k_neighbour,
  GMC.7.IGL.k_neighbour,
  GMC.8.IGL.k_neighbour,
  GMC.9.IGL.k_neighbour,
  GMC.10.IGL.k_neighbour
)
```

```{r}
GMC.1.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/1/shm_model/model_trivial_mm.csv")
GMC.2.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/2/shm_model/model_trivial_mm.csv")
GMC.3.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/3/shm_model/model_trivial_mm.csv")
GMC.4.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/4/shm_model/model_trivial_mm.csv")
GMC.5.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/5/shm_model/model_trivial_mm.csv")
GMC.6.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/6/shm_model/model_trivial_mm.csv")
GMC.7.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/7/shm_model/model_trivial_mm.csv")
GMC.8.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/8/shm_model/model_trivial_mm.csv")
GMC.9.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/9/shm_model/model_trivial_mm.csv")
GMC.10.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/10/shm_model/model_trivial_mm.csv")

GMC.IGH.trivial <- list(
  GMC.1.IGH.trivial,
  GMC.2.IGH.trivial,
  GMC.3.IGH.trivial,
  GMC.4.IGH.trivial,
  GMC.5.IGH.trivial,
  GMC.6.IGH.trivial,
  GMC.7.IGH.trivial,
  GMC.8.IGH.trivial,
  GMC.9.IGH.trivial,
  GMC.10.IGH.trivial
)
```

```{r}
GMC.1.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/1/shm_model/model_k_neighbour_mm.csv")
GMC.2.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/2/shm_model/model_k_neighbour_mm.csv")
GMC.3.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/3/shm_model/model_k_neighbour_mm.csv")
GMC.4.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/4/shm_model/model_k_neighbour_mm.csv")
GMC.5.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/5/shm_model/model_k_neighbour_mm.csv")
GMC.6.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/6/shm_model/model_k_neighbour_mm.csv")
GMC.7.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/7/shm_model/model_k_neighbour_mm.csv")
GMC.8.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/8/shm_model/model_k_neighbour_mm.csv")
GMC.9.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/9/shm_model/model_k_neighbour_mm.csv")
GMC.10.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/GMC/VJF_output_loci_IGH/10/shm_model/model_k_neighbour_mm.csv")

GMC.IGH.k_neighbour <- list(
  GMC.1.IGH.k_neighbour,
  GMC.2.IGH.k_neighbour,
  GMC.3.IGH.k_neighbour,
  GMC.4.IGH.k_neighbour,
  GMC.5.IGH.k_neighbour,
  GMC.6.IGH.k_neighbour,
  GMC.7.IGH.k_neighbour,
  GMC.8.IGH.k_neighbour,
  GMC.9.IGH.k_neighbour,
  GMC.10.IGH.k_neighbour
)
```

## Loading IDO

```{r}
IDO.11.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/11/shm_model/model_trivial_mm.csv")
IDO.12.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/12/shm_model/model_trivial_mm.csv")
IDO.13.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/13/shm_model/model_trivial_mm.csv")
IDO.14.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/14/shm_model/model_trivial_mm.csv")
IDO.15.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/15/shm_model/model_trivial_mm.csv")
IDO.16.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/16/shm_model/model_trivial_mm.csv")
IDO.17.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/17/shm_model/model_trivial_mm.csv")
IDO.18.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/18/shm_model/model_trivial_mm.csv")
IDO.19.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/19/shm_model/model_trivial_mm.csv")
IDO.20.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/20/shm_model/model_trivial_mm.csv")

IDO.IG.trivial <- list(
  IDO.11.IG.trivial,
  IDO.12.IG.trivial,
  IDO.13.IG.trivial,
  IDO.14.IG.trivial,
  IDO.15.IG.trivial,
  IDO.16.IG.trivial,
  IDO.17.IG.trivial,
  IDO.18.IG.trivial,
  IDO.19.IG.trivial,
  IDO.20.IG.trivial
)
```

```{r}
IDO.11.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/11/shm_model/model_k_neighbour_mm.csv")
IDO.12.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/12/shm_model/model_k_neighbour_mm.csv")
IDO.13.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/13/shm_model/model_k_neighbour_mm.csv")
IDO.14.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/14/shm_model/model_k_neighbour_mm.csv")
IDO.15.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/15/shm_model/model_k_neighbour_mm.csv")
IDO.16.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/16/shm_model/model_k_neighbour_mm.csv")
IDO.17.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/17/shm_model/model_k_neighbour_mm.csv")
IDO.18.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/18/shm_model/model_k_neighbour_mm.csv")
IDO.19.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/19/shm_model/model_k_neighbour_mm.csv")
IDO.20.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IG/20/shm_model/model_k_neighbour_mm.csv")

IDO.IG.k_neighbour <- list(
  IDO.11.IG.k_neighbour,
  IDO.12.IG.k_neighbour,
  IDO.13.IG.k_neighbour,
  IDO.14.IG.k_neighbour,
  IDO.15.IG.k_neighbour,
  IDO.16.IG.k_neighbour,
  IDO.17.IG.k_neighbour,
  IDO.18.IG.k_neighbour,
  IDO.19.IG.k_neighbour,
  IDO.20.IG.k_neighbour
)
```

```{r}
IDO.11.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/11/shm_model/model_trivial_mm.csv")
IDO.12.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/12/shm_model/model_trivial_mm.csv")
IDO.13.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/13/shm_model/model_trivial_mm.csv")
IDO.14.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/14/shm_model/model_trivial_mm.csv")
IDO.15.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/15/shm_model/model_trivial_mm.csv")
IDO.16.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/16/shm_model/model_trivial_mm.csv")
IDO.17.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/17/shm_model/model_trivial_mm.csv")
IDO.18.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/18/shm_model/model_trivial_mm.csv")
IDO.19.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/19/shm_model/model_trivial_mm.csv")
IDO.20.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/20/shm_model/model_trivial_mm.csv")

IDO.IGK.trivial <- list(
  IDO.11.IGK.trivial,
  IDO.12.IGK.trivial,
  IDO.13.IGK.trivial,
  IDO.14.IGK.trivial,
  IDO.15.IGK.trivial,
  IDO.16.IGK.trivial,
  IDO.17.IGK.trivial,
  IDO.18.IGK.trivial,
  IDO.19.IGK.trivial,
  IDO.20.IGK.trivial
)
```

```{r}
IDO.11.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/11/shm_model/model_k_neighbour_mm.csv")
IDO.12.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/12/shm_model/model_k_neighbour_mm.csv")
IDO.13.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/13/shm_model/model_k_neighbour_mm.csv")
IDO.14.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/14/shm_model/model_k_neighbour_mm.csv")
IDO.15.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/15/shm_model/model_k_neighbour_mm.csv")
IDO.16.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/16/shm_model/model_k_neighbour_mm.csv")
IDO.17.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/17/shm_model/model_k_neighbour_mm.csv")
IDO.18.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/18/shm_model/model_k_neighbour_mm.csv")
IDO.19.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/19/shm_model/model_k_neighbour_mm.csv")
IDO.20.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGK/20/shm_model/model_k_neighbour_mm.csv")

IDO.IGK.k_neighbour <- list(
  IDO.11.IGK.k_neighbour,
  IDO.12.IGK.k_neighbour,
  IDO.13.IGK.k_neighbour,
  IDO.14.IGK.k_neighbour,
  IDO.15.IGK.k_neighbour,
  IDO.16.IGK.k_neighbour,
  IDO.17.IGK.k_neighbour,
  IDO.18.IGK.k_neighbour,
  IDO.19.IGK.k_neighbour,
  IDO.20.IGK.k_neighbour
)
```

```{r}
IDO.11.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/11/shm_model/model_trivial_mm.csv")
IDO.12.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/12/shm_model/model_trivial_mm.csv")
IDO.13.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/13/shm_model/model_trivial_mm.csv")
IDO.14.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/14/shm_model/model_trivial_mm.csv")
IDO.15.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/15/shm_model/model_trivial_mm.csv")
IDO.16.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/16/shm_model/model_trivial_mm.csv")
IDO.17.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/17/shm_model/model_trivial_mm.csv")
IDO.18.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/18/shm_model/model_trivial_mm.csv")
IDO.19.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/19/shm_model/model_trivial_mm.csv")
IDO.20.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/20/shm_model/model_trivial_mm.csv")


IDO.IGL.trivial <- list(
  IDO.11.IGL.trivial,
  IDO.12.IGL.trivial,
  IDO.13.IGL.trivial,
  IDO.14.IGL.trivial,
  IDO.15.IGL.trivial,
  IDO.16.IGL.trivial,
  IDO.17.IGL.trivial,
  IDO.18.IGL.trivial,
  IDO.19.IGL.trivial,
  IDO.20.IGL.trivial
)
```

```{r}
IDO.11.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/11/shm_model/model_k_neighbour_mm.csv")
IDO.12.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/12/shm_model/model_k_neighbour_mm.csv")
IDO.13.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/13/shm_model/model_k_neighbour_mm.csv")
IDO.14.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/14/shm_model/model_k_neighbour_mm.csv")
IDO.15.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/15/shm_model/model_k_neighbour_mm.csv")
IDO.16.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/16/shm_model/model_k_neighbour_mm.csv")
IDO.17.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/17/shm_model/model_k_neighbour_mm.csv")
IDO.18.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/18/shm_model/model_k_neighbour_mm.csv")
IDO.19.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/19/shm_model/model_k_neighbour_mm.csv")
IDO.20.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGL/20/shm_model/model_k_neighbour_mm.csv")

IDO.IGL.k_neighbour <- list(
  IDO.11.IGL.k_neighbour,
  IDO.12.IGL.k_neighbour,
  IDO.13.IGL.k_neighbour,
  IDO.14.IGL.k_neighbour,
  IDO.15.IGL.k_neighbour,
  IDO.16.IGL.k_neighbour,
  IDO.17.IGL.k_neighbour,
  IDO.18.IGL.k_neighbour,
  IDO.19.IGL.k_neighbour,
  IDO.20.IGL.k_neighbour
)
```

```{r}
IDO.11.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/11/shm_model/model_trivial_mm.csv")
IDO.12.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/12/shm_model/model_trivial_mm.csv")
IDO.13.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/13/shm_model/model_trivial_mm.csv")
IDO.14.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/14/shm_model/model_trivial_mm.csv")
IDO.15.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/15/shm_model/model_trivial_mm.csv")
IDO.16.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/16/shm_model/model_trivial_mm.csv")
IDO.17.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/17/shm_model/model_trivial_mm.csv")
IDO.18.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/18/shm_model/model_trivial_mm.csv")
IDO.19.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/19/shm_model/model_trivial_mm.csv")
IDO.20.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/20/shm_model/model_trivial_mm.csv")


IDO.IGH.trivial <- list(
  IDO.11.IGH.trivial,
  IDO.12.IGH.trivial,
  IDO.13.IGH.trivial,
  IDO.14.IGH.trivial,
  IDO.15.IGH.trivial,
  IDO.16.IGH.trivial,
  IDO.17.IGH.trivial,
  IDO.18.IGH.trivial,
  IDO.19.IGH.trivial,
  IDO.20.IGH.trivial
)
```

```{r}
IDO.11.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/11/shm_model/model_k_neighbour_mm.csv")
IDO.12.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/12/shm_model/model_k_neighbour_mm.csv")
IDO.13.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/13/shm_model/model_k_neighbour_mm.csv")
IDO.14.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/14/shm_model/model_k_neighbour_mm.csv")
IDO.15.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/15/shm_model/model_k_neighbour_mm.csv")
IDO.16.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/16/shm_model/model_k_neighbour_mm.csv")
IDO.17.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/17/shm_model/model_k_neighbour_mm.csv")
IDO.18.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/18/shm_model/model_k_neighbour_mm.csv")
IDO.19.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/19/shm_model/model_k_neighbour_mm.csv")
IDO.20.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/IDO/VJF_output_loci_IGH/20/shm_model/model_k_neighbour_mm.csv")

IDO.IGH.k_neighbour <- list(
  IDO.11.IGH.k_neighbour,
  IDO.12.IGH.k_neighbour,
  IDO.13.IGH.k_neighbour,
  IDO.14.IGH.k_neighbour,
  IDO.15.IGH.k_neighbour,
  IDO.16.IGH.k_neighbour,
  IDO.17.IGH.k_neighbour,
  IDO.18.IGH.k_neighbour,
  IDO.19.IGH.k_neighbour,
  IDO.20.IGH.k_neighbour
)
```

## Loading FV 

```{r}
FV.21.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/21/shm_model/model_trivial_mm.csv")
FV.22.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/22/shm_model/model_trivial_mm.csv")
FV.23.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/23/shm_model/model_trivial_mm.csv")
FV.24.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/24/shm_model/model_trivial_mm.csv")
FV.25.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/25/shm_model/model_trivial_mm.csv")
FV.26.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/26/shm_model/model_trivial_mm.csv")
FV.27.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/27/shm_model/model_trivial_mm.csv")
FV.28.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/28/shm_model/model_trivial_mm.csv")
FV.29.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/29/shm_model/model_trivial_mm.csv")
FV.30.IG.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/30/shm_model/model_trivial_mm.csv")

FV.IG.trivial <- list(
  FV.21.IG.trivial,
  FV.22.IG.trivial,
  FV.23.IG.trivial,
  FV.24.IG.trivial,
  FV.25.IG.trivial,
  FV.26.IG.trivial,
  FV.27.IG.trivial,
  FV.28.IG.trivial,
  FV.29.IG.trivial,
  FV.30.IG.trivial
)
```

```{r}
FV.21.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/21/shm_model/model_k_neighbour_mm.csv")
FV.22.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/22/shm_model/model_k_neighbour_mm.csv")
FV.23.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/23/shm_model/model_k_neighbour_mm.csv")
FV.24.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/24/shm_model/model_k_neighbour_mm.csv")
FV.25.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/25/shm_model/model_k_neighbour_mm.csv")
FV.26.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/26/shm_model/model_k_neighbour_mm.csv")
FV.27.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/27/shm_model/model_k_neighbour_mm.csv")
FV.28.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/28/shm_model/model_k_neighbour_mm.csv")
FV.29.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/29/shm_model/model_k_neighbour_mm.csv")
FV.30.IG.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IG/30/shm_model/model_k_neighbour_mm.csv")

FV.IG.k_neighbour <- list(
  FV.21.IG.k_neighbour,
  FV.22.IG.k_neighbour,
  FV.23.IG.k_neighbour,
  FV.24.IG.k_neighbour,
  FV.25.IG.k_neighbour,
  FV.26.IG.k_neighbour,
  FV.27.IG.k_neighbour,
  FV.28.IG.k_neighbour,
  FV.29.IG.k_neighbour,
  FV.30.IG.k_neighbour
)
```

```{r}
FV.21.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/21/shm_model/model_trivial_mm.csv")
FV.22.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/22/shm_model/model_trivial_mm.csv")
FV.23.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/23/shm_model/model_trivial_mm.csv")
FV.24.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/24/shm_model/model_trivial_mm.csv")
FV.25.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/25/shm_model/model_trivial_mm.csv")
FV.26.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/26/shm_model/model_trivial_mm.csv")
FV.27.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/27/shm_model/model_trivial_mm.csv")
FV.28.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/28/shm_model/model_trivial_mm.csv")
FV.29.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/29/shm_model/model_trivial_mm.csv")
FV.30.IGK.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/30/shm_model/model_trivial_mm.csv")

FV.IGK.trivial <- list(
  FV.21.IGK.trivial,
  FV.22.IGK.trivial,
  FV.23.IGK.trivial,
  FV.24.IGK.trivial,
  FV.25.IGK.trivial,
  FV.26.IGK.trivial,
  FV.27.IGK.trivial,
  FV.28.IGK.trivial,
  FV.29.IGK.trivial,
  FV.30.IGK.trivial
)
```

```{r}
FV.21.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/21/shm_model/model_k_neighbour_mm.csv")
FV.22.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/22/shm_model/model_k_neighbour_mm.csv")
FV.23.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/23/shm_model/model_k_neighbour_mm.csv")
FV.24.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/24/shm_model/model_k_neighbour_mm.csv")
FV.25.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/25/shm_model/model_k_neighbour_mm.csv")
FV.26.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/26/shm_model/model_k_neighbour_mm.csv")
FV.27.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/27/shm_model/model_k_neighbour_mm.csv")
FV.28.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/28/shm_model/model_k_neighbour_mm.csv")
FV.29.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/29/shm_model/model_k_neighbour_mm.csv")
FV.30.IGK.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGK/30/shm_model/model_k_neighbour_mm.csv")

FV.IGK.k_neighbour <- list(
  FV.21.IGK.k_neighbour,
  FV.22.IGK.k_neighbour,
  FV.23.IGK.k_neighbour,
  FV.24.IGK.k_neighbour,
  FV.25.IGK.k_neighbour,
  FV.26.IGK.k_neighbour,
  FV.27.IGK.k_neighbour,
  FV.28.IGK.k_neighbour,
  FV.29.IGK.k_neighbour,
  FV.30.IGK.k_neighbour
)
```

```{r}
FV.21.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/21/shm_model/model_trivial_mm.csv")
FV.22.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/22/shm_model/model_trivial_mm.csv")
FV.23.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/23/shm_model/model_trivial_mm.csv")
FV.24.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/24/shm_model/model_trivial_mm.csv")
FV.25.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/25/shm_model/model_trivial_mm.csv")
FV.26.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/26/shm_model/model_trivial_mm.csv")
FV.27.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/27/shm_model/model_trivial_mm.csv")
FV.28.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/28/shm_model/model_trivial_mm.csv")
FV.29.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/29/shm_model/model_trivial_mm.csv")
FV.30.IGL.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/30/shm_model/model_trivial_mm.csv")

FV.IGL.trivial <- list(
  FV.21.IGL.trivial,
  FV.22.IGL.trivial,
  FV.23.IGL.trivial,
  FV.24.IGL.trivial,
  FV.25.IGL.trivial,
  FV.26.IGL.trivial,
  FV.27.IGL.trivial,
  FV.28.IGL.trivial,
  FV.29.IGL.trivial,
  FV.30.IGL.trivial
)
```

```{r}
FV.21.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/21/shm_model/model_k_neighbour_mm.csv")
FV.22.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/22/shm_model/model_k_neighbour_mm.csv")
FV.23.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/23/shm_model/model_k_neighbour_mm.csv")
FV.24.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/24/shm_model/model_k_neighbour_mm.csv")
FV.25.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/25/shm_model/model_k_neighbour_mm.csv")
FV.26.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/26/shm_model/model_k_neighbour_mm.csv")
FV.27.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/27/shm_model/model_k_neighbour_mm.csv")
FV.28.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/28/shm_model/model_k_neighbour_mm.csv")
FV.29.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/29/shm_model/model_k_neighbour_mm.csv")
FV.30.IGL.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGL/30/shm_model/model_k_neighbour_mm.csv")

FV.IGL.k_neighbour <- list(
  FV.21.IGL.k_neighbour,
  FV.22.IGL.k_neighbour,
  FV.23.IGL.k_neighbour,
  FV.24.IGL.k_neighbour,
  FV.25.IGL.k_neighbour,
  FV.26.IGL.k_neighbour,
  FV.27.IGL.k_neighbour,
  FV.28.IGL.k_neighbour,
  FV.29.IGL.k_neighbour,
  FV.30.IGL.k_neighbour
)
```

```{r}
FV.21.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/21/shm_model/model_trivial_mm.csv")
FV.22.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/22/shm_model/model_trivial_mm.csv")
FV.23.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/23/shm_model/model_trivial_mm.csv")
FV.24.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/24/shm_model/model_trivial_mm.csv")
FV.25.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/25/shm_model/model_trivial_mm.csv")
FV.26.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/26/shm_model/model_trivial_mm.csv")
FV.27.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/27/shm_model/model_trivial_mm.csv")
FV.28.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/28/shm_model/model_trivial_mm.csv")
FV.29.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/29/shm_model/model_trivial_mm.csv")
FV.30.IGH.trivial <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/30/shm_model/model_trivial_mm.csv")

FV.IGH.trivial <- list(
  FV.21.IGH.trivial,
  FV.22.IGH.trivial,
  FV.23.IGH.trivial,
  FV.24.IGH.trivial,
  FV.25.IGH.trivial,
  FV.26.IGH.trivial,
  FV.27.IGH.trivial,
  FV.28.IGH.trivial,
  FV.29.IGH.trivial,
  FV.30.IGH.trivial
)
```

```{r}
FV.21.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/21/shm_model/model_k_neighbour_mm.csv")
FV.22.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/22/shm_model/model_k_neighbour_mm.csv")
FV.23.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/23/shm_model/model_k_neighbour_mm.csv")
FV.24.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/24/shm_model/model_k_neighbour_mm.csv")
FV.25.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/25/shm_model/model_k_neighbour_mm.csv")
FV.26.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/26/shm_model/model_k_neighbour_mm.csv")
FV.27.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/27/shm_model/model_k_neighbour_mm.csv")
FV.28.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/28/shm_model/model_k_neighbour_mm.csv")
FV.29.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/29/shm_model/model_k_neighbour_mm.csv")
FV.30.IGH.k_neighbour <- shm.k.mer.model.reader("./Sid/abzikadze/datasets/AbVitro/flu_time_course/FV/VJF_output_loci_IGH/30/shm_model/model_k_neighbour_mm.csv")

FV.IGH.k_neighbour <- list(
  FV.21.IGH.k_neighbour,
  FV.22.IGH.k_neighbour,
  FV.23.IGH.k_neighbour,
  FV.24.IGH.k_neighbour,
  FV.25.IGH.k_neighbour,
  FV.26.IGH.k_neighbour,
  FV.27.IGH.k_neighbour,
  FV.28.IGH.k_neighbour,
  FV.29.IGH.k_neighbour,
  FV.30.IGH.k_neighbour
)
```


```{r}
before.flu = 3
```


# Trivial vs k-neighbour

```{r}
trivial.minus.kn <- function(x, y) {
  1 - y$N / x$N
}
```

```{r}
hist(mapply(trivial.minus.kn, GMC.IGK.trivial[1:before.flu], GMC.IGK.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IGL.trivial[1:before.flu], GMC.IGL.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IGH.trivial[1:before.flu], GMC.IGH.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IG.trivial[1:before.flu], GMC.IG.k_neighbour[1:before.flu]), freq=F)

hist(mapply(trivial.minus.kn, GMC.IGK.trivial[-(1:before.flu)], GMC.IGK.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IGL.trivial[-(1:before.flu)], GMC.IGL.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IGH.trivial[-(1:before.flu)], GMC.IGH.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, GMC.IG.trivial[-(1:before.flu)], GMC.IG.k_neighbour[-(1:before.flu)]), freq=F)
```

```{r}
hist(mapply(trivial.minus.kn, IDO.IGK.trivial[1:before.flu], IDO.IGK.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IGL.trivial[1:before.flu], IDO.IGL.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IGH.trivial[1:before.flu], IDO.IGH.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IG.trivial[1:before.flu],  IDO.IG.k_neighbour[1:before.flu]), freq=F)

hist(mapply(trivial.minus.kn, IDO.IGK.trivial[-(1:before.flu)], IDO.IGK.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IGL.trivial[-(1:before.flu)], IDO.IGL.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IGH.trivial[-(1:before.flu)], IDO.IGH.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, IDO.IG.trivial[-(1:before.flu)],  IDO.IG.k_neighbour[-(1:before.flu)]), freq=F)
```

```{r}
hist(mapply(trivial.minus.kn, FV.IGK.trivial[1:before.flu], FV.IGK.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, FV.IGL.trivial[1:before.flu], FV.IGL.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, FV.IGH.trivial[1:before.flu], FV.IGH.k_neighbour[1:before.flu]), freq=F)
hist(mapply(trivial.minus.kn, FV.IG.trivial[1:before.flu],  FV.IG.k_neighbour[1:before.flu]), freq=F)

hist(mapply(trivial.minus.kn, FV.IGK.trivial[-(1:before.flu)], FV.IGK.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, FV.IGL.trivial[-(1:before.flu)], FV.IGL.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, FV.IGH.trivial[-(1:before.flu)], FV.IGH.k_neighbour[-(1:before.flu)]), freq=F)
hist(mapply(trivial.minus.kn, FV.IG.trivial[-(1:before.flu)],  FV.IG.k_neighbour[-(1:before.flu)]), freq=F)
```

```{r}
median(mapply(trivial.minus.kn, GMC.IGK.trivial, GMC.IGK.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, GMC.IGL.trivial, GMC.IGL.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, GMC.IGH.trivial, GMC.IGH.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, GMC.IG.trivial, GMC.IG.k_neighbour), na.rm=TRUE)
```

```{r}
median(mapply(trivial.minus.kn, IDO.IGK.trivial, IDO.IGK.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, IDO.IGL.trivial, IDO.IGL.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, IDO.IGH.trivial, IDO.IGH.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, IDO.IG.trivial, IDO.IG.k_neighbour), na.rm=TRUE)
```

```{r}
median(mapply(trivial.minus.kn, FV.IGK.trivial, FV.IGK.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, FV.IGL.trivial, FV.IGL.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, FV.IGH.trivial, FV.IGH.k_neighbour), na.rm=TRUE)
median(mapply(trivial.minus.kn, FV.IG.trivial, FV.IG.k_neighbour), na.rm=TRUE)
```

```{r}
mean(mapply(trivial.minus.kn, GMC.IGK.trivial, GMC.IGK.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, GMC.IGL.trivial, GMC.IGL.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, GMC.IGH.trivial, GMC.IGH.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, GMC.IG.trivial, GMC.IG.k_neighbour), na.rm=TRUE)
```

```{r}
mean(mapply(trivial.minus.kn, IDO.IGK.trivial, IDO.IGK.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, IDO.IGL.trivial, IDO.IGL.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, IDO.IGH.trivial, IDO.IGH.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, IDO.IG.trivial, IDO.IG.k_neighbour), na.rm=TRUE)
```

```{r}
mean(mapply(trivial.minus.kn, FV.IGK.trivial, FV.IGK.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, FV.IGL.trivial, FV.IGL.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, FV.IGH.trivial, FV.IGH.k_neighbour), na.rm=TRUE)
mean(mapply(trivial.minus.kn, FV.IG.trivial, FV.IG.k_neighbour), na.rm=TRUE)
```

```{r}
cor.mm.method <- function(df1, df2) {
  diag(cor(df1, df2, use="na.or.complete"))
}
```

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGK.trivial, GMC.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGL.trivial, GMC.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGH.trivial, GMC.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IG.trivial, GMC.IG.k_neighbour)))
```

GMC 8 --- бедный датасет. После сборки баркодов его объем упал.
Этот датасет обладает минимальной корреляцией trivial и k_neighbour.
Для него минимальный объем выравниваний на V-gen в IGL модели (10KB). 

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGK.trivial[1:before.flu], GMC.IGK.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IGL.trivial[1:before.flu], GMC.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IGH.trivial[1:before.flu], GMC.IGH.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IG.trivial[1:before.flu], GMC.IG.k_neighbour[1:before.flu])))
```

```{r}
boxplot(t(mapply(cor.mm.method, IDO.IGK.trivial, IDO.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGL.trivial, IDO.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGH.trivial, IDO.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IG.trivial, IDO.IG.k_neighbour)))
```

```{r}
boxplot(t(mapply(cor.mm.method, FV.IGK.trivial, FV.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IGL.trivial, FV.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IGH.trivial, FV.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IG.trivial, FV.IG.k_neighbour)))
```

FV 5 -- очень странный датасет. Для него отсутствуют raw_reads. Возможно, что он 454. Датасет не пригоден для построения модели.

Таким образом, есть (исключая, FV 5 и GMC 8) консистентность before, after flu.
И на всех датасетах и типах цепей корреляция больше 85 процентов.


# IGH vs IGK

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[1:before.flu], GMC.IGK.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour[1:before.flu], IDO.IGK.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour [1:before.flu], FV.IGK.k_neighbour [1:before.flu])))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[-(1:before.flu)], GMC.IGK.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour[-(1:before.flu)], IDO.IGK.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour [-(1:before.flu)], FV.IGK.k_neighbour [-(1:before.flu)])))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour, GMC.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour, IDO.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour, FV.IGK.k_neighbour)))
```

# IGH vs IGL

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[1:before.flu], GMC.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour[1:before.flu], IDO.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour [1:before.flu], FV.IGL.k_neighbour [1:before.flu])))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[-(1:before.flu)], GMC.IGL.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour[-(1:before.flu)], IDO.IGL.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour [-(1:before.flu)], FV.IGL.k_neighbour [-(1:before.flu)])))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour, GMC.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour, IDO.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IGH.k_neighbour, FV.IGL.k_neighbour)))
```

# IGK vs IGL

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour[1:before.flu], GMC.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, IDO.IGK.k_neighbour[1:before.flu], IDO.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, FV.IGK.k_neighbour [1:before.flu], FV.IGL.k_neighbour [1:before.flu])))

boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour[-(1:before.flu)], GMC.IGL.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, IDO.IGK.k_neighbour[-(1:before.flu)], IDO.IGL.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, FV.IGK.k_neighbour [-(1:before.flu)], FV.IGL.k_neighbour [-(1:before.flu)])))

boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour, GMC.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGK.k_neighbour, IDO.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, FV.IGK.k_neighbour, FV.IGL.k_neighbour)))
```

Conclusion: bad correlations (~.5--.65).

# IG* vs IG* within individuals

```{r}
t(outer(GMC.IGH.k_neighbour[1:before.flu], GMC.IGH.k_neighbour[1:before.flu], "+"))
```


# Individuals vs individuals

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour, IDO.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour, IDO.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGL.k_neighbour, IDO.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IG.k_neighbour, IDO.IG.k_neighbour)))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[1:before.flu], IDO.IGH.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour[1:before.flu], IDO.IGK.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IGL.k_neighbour[1:before.flu], IDO.IGL.k_neighbour[1:before.flu])))
boxplot(t(mapply(cor.mm.method, GMC.IG.k_neighbour [1:before.flu], IDO.IG.k_neighbour [1:before.flu])))

boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour[-(1:before.flu)], IDO.IGH.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour[-(1:before.flu)], IDO.IGK.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, GMC.IGL.k_neighbour[-(1:before.flu)], IDO.IGL.k_neighbour[-(1:before.flu)])))
boxplot(t(mapply(cor.mm.method, GMC.IG.k_neighbour [-(1:before.flu)], IDO.IG.k_neighbour [-(1:before.flu)])))
```

```{r}
boxplot(t(mapply(cor.mm.method, GMC.IGH.k_neighbour, FV.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGK.k_neighbour, FV.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IGL.k_neighbour, FV.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, GMC.IG.k_neighbour, FV.IG.k_neighbour)))
```

```{r}
boxplot(t(mapply(cor.mm.method, IDO.IGH.k_neighbour, FV.IGH.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGK.k_neighbour, FV.IGK.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IGL.k_neighbour, FV.IGL.k_neighbour)))
boxplot(t(mapply(cor.mm.method, IDO.IG.k_neighbour, FV.IG.k_neighbour)))
```


# Dirichlet distribution

```{r}
library("rgl")
library("akima")
```

```{r}
grid.N <- 1e2
grid <- seq(0, 1, length.out = grid.N)
grid <- do.call(rbind, lapply(grid, function(x) { 
  cbind(rep(x, grid.N * (1 - x)),
        seq(from = 0, to = 1 - x, length.out = grid.N * (1 - x)))
}))

grid <- cbind(grid, 1 - rowSums(grid))
head(grid)
```

```{r}
plot.dirichlet <- function(kmer, datasets, direchlet.dimention = 3, color = "black") {
  samp <- t(sapply(datasets, function(x) x[kmer,]))
  samp <- matrix(unlist(samp), ncol = direchlet.dimention + 1)
  kmer.central.nucl <- strsplit(kmer, "")[[1]][3]
  samp <- samp[,-which(c("A", "C", "G", "T") == kmer.central.nucl)]
      
  res <- optim(par = rep(10, direchlet.dimention), gr = minuslog.grad,
        fn = minuslog, samp = samp, lower = rep(0.1, direchlet.dimention), method = "L-BFGS-B")
  res$par / sum(res$par)
  
  
  z <- ddirichlet(grid, res$par)
  z[z==Inf] <- 0
  #s=interp(grid[,1], grid[,2], z)
  plot3d( grid[,1], grid[,2], z, col = color)
  #surface3d(s$x, s$y, s$z)
  res
}
```

```{r}
datasets.before.flu = list(
  GMC.IGH.k_neighbour[[1]], GMC.IGH.k_neighbour[[2]], GMC.IGH.k_neighbour[[3]],
  IDO.IGH.k_neighbour[[1]], IDO.IGH.k_neighbour[[2]], IDO.IGH.k_neighbour[[3]],
  FV.IGH.k_neighbour [[1]], FV.IGH.k_neighbour [[2]], FV.IGH.k_neighbour [[3]]
)
```

```{r}
datasets.after.flu = list(
  GMC.IGH.k_neighbour[[4]], GMC.IGH.k_neighbour[[5]], GMC.IGH.k_neighbour[[6]],GMC.IGH.k_neighbour[[7]],GMC.IGH.k_neighbour[[8]],GMC.IGH.k_neighbour[[9]],
  GMC.IGH.k_neighbour[[10]],
  IDO.IGH.k_neighbour[[4]], IDO.IGH.k_neighbour[[5]], IDO.IGH.k_neighbour[[6]],IDO.IGH.k_neighbour[[7]],IDO.IGH.k_neighbour[[8]],IDO.IGH.k_neighbour[[9]],
  IDO.IGH.k_neighbour[[9]],
  FV.IGH.k_neighbour [[4]], FV.IGH.k_neighbour [[5]], FV.IGH.k_neighbour [[6]],FV.IGH.k_neighbour [[7]],FV.IGH.k_neighbour [[8]],FV.IGH.k_neighbour [[9]],
  FV.IGH.k_neighbour [[10]]
)
```

```


```{r}
head(sort(rowSums(Reduce("+", datasets.before.flu)), decreasing = TRUE), 100)
```

```{r}
#open3d()
plot.dirichlet(kmer = 'GTGTA', datasets = datasets.before.flu)$par
plot.dirichlet(kmer = 'AGCTG', datasets = datasets.before.flu, color = "red")$par
plot.dirichlet(kmer = 'GAGCT', datasets = datasets.before.flu, color = "red")$par
plot.dirichlet(kmer = 'CAGCT', datasets = datasets.before.flu, color = "red")$par
plot.dirichlet(kmer = 'GGGCT', datasets = datasets.before.flu, color = "red")$par
plot.dirichlet(kmer = 'GGGCT', datasets = datasets.before.flu, color = "red")$par
rrr = plot.dirichlet(kmer = 'GTATC', datasets = datasets.before.flu, color = "red")$par
rrr / sum(rrr)
```

```{r}
plot.dirichlet(kmer = 'GTGTA', datasets = datasets.after.flu)$par
plot.dirichlet(kmer = 'AGCTG', datasets = datasets.after.flu, color = "blue")$par
plot.dirichlet(kmer = 'GAGCT', datasets = datasets.after.flu, color = "red")$par
plot.dirichlet(kmer = 'CAGCT', datasets = datasets.after.flu, color = "red")$par
plot.dirichlet(kmer = 'GGGCT', datasets = datasets.after.flu, color = "blue")$par
plot.dirichlet(kmer = 'GGGCT', datasets = datasets.after.flu, color = "blue")$par
open3d()
```

